import json
import logging

import streamlit as st
from cryptography.fernet import Fernet

ENCRYPTED_CREDENTIALS_NAME = "ENCRYPTED_CREDENTIALS"
ENCRYPTED_CREDENTIALS = b'gAAAAABiEyLpxoV6OqypLCDTT4u3mKTV1lmmQocMfFUP3bNDe7WYjXxRUPssO1WXLAfJSpZ-umiL12cgoJyxehDpFuAEYamTHPBFe3T3MGjoOYqGcXcQ-7mSHbJhTFvR3hhIE0VKowyFcgU2Hwgx6DFzM-A3gCt7focRFB4tjeeW6qVy7ZWPwpWqMcwzXw8txMnt9Bce7RoZ3EMNr3UyoxeWlgsvhNFZ4Nm-c_DkpmPiHfS3CoBK-PlC7JkuMUWrBDuIexRAIK5oconjWoPada5m5rKXlqsDnW8gRB9FaffELrVohDgEo79ZWhwnVFCnIZI4Fh9memVd6H6jd975vNSEh46oEAXBactUWOW_Hkw7XWl1Uz5JXznBkNdPP94h7PbXIXtns4hRpbx1TjXvvaGYL2I5e5cGP_UWcQ6Pg2NHgdbJjzi_g4o6Hlv7WharM5GC9nkhIuYavRmWCexPgaWNWRQpdpzXMnw3bEi66w4LIm4o2WAfLzvzwv0BC4p0zQmBX2qAfIh2mKHyOiRRH-AhvO3RIEfLpi0wkw6HiK_TtP60cb5SzEsmrm2PVM8t36mGkIE5e3vRaMJd0C25qUvV-N_s6rzV5Zetx3vGwcKVfjuGMlFOTsSxQZ25-W_yIEe5o1O2-azNbEVC_9oCjCwe3Yjkw5b7t3VJH9eWcXk4poxf6d8rnutHnAgkrMsWwFDnItt50s6Vov8j_evNewtz-py2cxq1b2vkKZ-vpGReYMN9vNPGLB4SSGEpLwadtMeuGE6jtc0ybnCTGzglg29qB-WMhg39cZ7UA1JwgQZStOqbtDVmU-RklvsI-OjQfOoOkagxNxgOq8HloNFyFVF_HlqMSjHSr1zhcuOM-DchlVsmQ5_rEQt9A1oZCxjQBmiEsAqKGp0RAOoX0-ueJW2wZ2P380dsSE8rVzQAIeRfur0dExVREtdao38ld9gg3U8mTpRHhUJjwUR_vOFG7tp3dxRK0X3Y9cqaiZKomq2pNI5VreMDpnv5EnHPghIC8LA-sjikLZlutYaqEt_Va3LX_UV10WYPSqGFoJDW91UxOiXbvbtWEAfe9QNhQGS9H15spEw87yne-q_Kyp8PVVOXi6O41-TI5y0Kpkc5xqr1eTwwBB6cOdUT9mQsjc8iR3kmU7j-7GrGmbcSFl1O0r_bO_QYrJUC4emvmTIT05Lt_YprV17BpIr7nOizUHeqt0kaVYpGN9BHv8j85joKFp3CcmJgc2CCKvrr4BygAJNDLEYC06m67GBgYOznhMY6cE7DcNsqtMUwEr4p3yNzChDS0SJCWsj33VMVTgJPeYftuY_PhIfYqNG5XOUUb4zBmVKzyRhCRf9YxcG5PZYbB97SldIMvf9TipBj-Lu1KA74x_wIq60ocQpvWetwlnbhyw0huErBMjPCADgV7INuS48T4hs_2FIpMqi_e8hRutqE0x93P7AGYckgg61EVgjQl_0BHcJ3nR93-d7wJIF4UfonnautbGEqFUkW-4zQuavccpHcdDxLyWt_amytV8Zm8Xe48r1-y5qxlFcbUtX5D9Vn4oGz5HTmjoRFaSKnERuaFeCScVprmpo3R3fzNrVjt1rVl-XURKTw6JrMU8xh6Huxq1JlcMdcpCn-897sy1C55FWpDyKUHHANir6Gsz0SQFB6faGv3iB8O_F-R3phsuZG_frnmt_PuFpp1yy32NQJbFGOw2HRfuqt_9vHTZnDgSLldNz6R75bzQHl4zOkt39UEzpMvxKl0sitt7_EfFv0jTkmUNkUxd4QnP4KtE7M32bPHs0eh8tnA5kRkfsxIJvwgDT7no1lboYkA2kQUNOxgR_S7u98bpoa435Ruwnor_kn5iSU277uorcZEZZ-a84iwgMFf4OH5nGfxktWXgOrYVh_mc9PzIwWxUxoVpVp0Ni_5T73NEG-eUeI3mGcy8gASz6bNKLejRwIYHo-wAlzt_lrBGfdFzSEJ7tWkxvTiitNPYJsyNyz_fcwht5a9N-Kj0nIztijzxzwwAfSvQcbpGbTnx_xdomz29T5MjBqbLP84s5V0-DWk_pTM5dx59yFGbbkVJ78cNs_7YeRz7ovVnP9NZRqtBuO4a_nSs3k0fYr7dA3FDWTs8g5xAWf8G_Z0F4257d_iPBBNDANgZ19TKakKcZeqnSic5a3hbRJwY1MxtuDzer9BnY-0piD9fkYCzpdTXa5QEym75Yt8jwtAG_DmqVM9wNisnPaGRV01UfCSbWQdb2nz1EeuHE29S56WEO1XTOpluxinyaGi1wZTU-4hufJOCemf0r41nDA53KMfEvnRamxFtRFlVgwUuhxoajdMqUboOcOtDIxw4w4YAqfx2KrWaAb-dvz1bphIulmIOFlCzbu18dKoOrppZ8ds7VkWJown-Qvi0aCDXi94OFhwDquZi7jHw7aNu_Pp_uYRchG_khMfDFPLkZHtN6NishlTOUpHdxd2i45HAWQCzWy-McGgVisezlQaNPYnidiFIAzDT4MWgaOZkBflrTYTwY3H2e7rPfgx5U13akIc5YNrCntH4Hwq0CIexMuYUqCQFl5yuDJ0D6HxiY5BrZzYmQHzmOXDvNvYYfXrH5sZhk9Zv5naVUDXX_vXbFVFVq3EnI73Zkqc_iTIbfho_TW-RoMbGOK4v5VagNx6UOq6OR_7shFGjkymPZ895ebbN348hwCWpb8xDhcCmejt13j5UwVjEN1jDT22aJvaSECiGaTEdOu_q_k1wzO37Z5-OZ8wO54zESOf2zfc1-c1KXr3sUmYMw2uHDVfpp743IDnRRVUWXI6ihhzCU1zH6NLYGRK6XB7V247wnN1ur3QwQy0QX8TKOe6K1sq6R2NiRTNTA8SZbAj8H3bdw58OoPXVKbrUnfO6_n_IEiGZvmKshLQn_uJakFsywB1v7u1B7ERzuHzO41jzuV0dLJhCC_wwLXT7agCNxI9Y8M2gmd1TyBD6oRZ0SlGUpaeV5EZ94QF5apFfLBRBPOYEfrFkHUtHHCQlAO-LxXy0v8_hlQOfiQU-6oM2fNjfaYkHfhz9SHwD01Y385KFsQA-aDVNyHuOLX66pE4qb_kP2k_ygOzmpyTREB_5qqiYxLcSwI7ddPHcMlgb2pNfpNlfZ3B0rHakccC-LHcpSh'

def get_credentials(key: str) -> dict[str, str]:
    if ENCRYPTED_CREDENTIALS_NAME in st.secrets:
        logging.warning(f'Getting credentials from secrets')
        raw_credentials = str.encode(st.secrets[ENCRYPTED_CREDENTIALS_NAME])
    else:
        logging.warning(f'Getting credentials from code')
        raw_credentials = ENCRYPTED_CREDENTIALS

    f = Fernet(str.encode(key))

    decrypted: bytes = f.decrypt(raw_credentials)

    return json.loads(s=bytes.decode(decrypted))